import{e as _,c as i,o as s,a as t,x as N,F as T,z as P,n as p,t as c,k as U,_ as b,d as S,f as z,r as C,p as E,m as H,C as O,q as M,w as q,s as J,h as y,b as G}from"./DY1PNkpc.js";import{u as K}from"./BSLYW5y6.js";import{s as Q}from"./x_rD_Ya3.js";import"./QImbNDE7.js";import"./WQK9bC3l.js";const W={class:"bg-white rounded-xl shadow-sm border border-gray-50 overflow-hidden"},X={key:0,class:"flex items-center justify-center py-12"},Y={key:1,class:"divide-y divide-gray-100 max-h-[calc(100vh-300px)] overflow-y-auto"},Z=["onClick"],tt={class:"flex items-start gap-3"},et={class:"flex-shrink-0 mt-1"},ot={class:"flex-1 min-w-0"},st={class:"flex items-start justify-between gap-2 mb-1"},nt={key:0,class:"flex-shrink-0"},at={class:"text-sm text-gray-600 line-clamp-2 mb-2"},it={class:"flex items-center justify-between"},rt={class:"text-xs text-gray-500"},lt={class:"flex items-center gap-2"},dt=["onClick"],ct=["onClick"],ut={key:0,class:"px-6 py-12 text-center"},mt=_({__name:"NotificationList",props:{notifications:{},selectedId:{},loading:{type:Boolean}},emits:["select","mark-read","mark-unread","refresh"],setup(k){const u=n=>({urgent:"bg-red-500",high:"bg-orange-500",normal:"bg-gray-400"})[n]||"bg-gray-400",d=n=>{const e=new Date(n),a=Math.floor((new Date().getTime()-e.getTime())/1e3);return a<60?"Just now":a<3600?`${Math.floor(a/60)}m ago`:a<86400?`${Math.floor(a/3600)}h ago`:a<604800?`${Math.floor(a/86400)}d ago`:e.toLocaleDateString("en-US",{month:"short",day:"numeric"})};return(n,e)=>(s(),i("div",W,[e[3]||(e[3]=t("div",{class:"px-6 py-4 border-b border-gray-100"},[t("h2",{class:"text-lg font-semibold text-gray-900"},"Notifications")],-1)),n.loading&&!n.notifications.length?(s(),i("div",X,e[0]||(e[0]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#005B8F]"},null,-1)]))):(s(),i("div",Y,[(s(!0),i(T,null,P(n.notifications,o=>(s(),i("div",{key:o.notification_id,onClick:a=>n.$emit("select",o),class:p(["px-6 py-4 cursor-pointer transition-colors hover:bg-gray-50",n.selectedId===o.notification_id&&"bg-blue-50",!o.read&&"bg-blue-25"])},[t("div",tt,[t("div",et,[t("div",{class:p(["w-2 h-2 rounded-full",u(o.priority)])},null,2)]),t("div",ot,[t("div",st,[t("h3",{class:p(["text-sm font-medium",o.read?"text-gray-600":"text-gray-900"])},c(o.title),3),o.read?N("",!0):(s(),i("div",nt,e[1]||(e[1]=[t("div",{class:"w-2 h-2 bg-[#005B8F] rounded-full"},null,-1)])))]),t("p",at,c(o.message),1),t("div",it,[t("span",rt,c(d(o.timestamp)),1),t("div",lt,[o.read?(s(),i("button",{key:1,onClick:U(a=>n.$emit("mark-unread",o.notification_id),["stop"]),class:"text-xs text-gray-600 hover:text-gray-800 font-medium"}," Mark as unread ",8,ct)):(s(),i("button",{key:0,onClick:U(a=>n.$emit("mark-read",o.notification_id),["stop"]),class:"text-xs text-blue-600 hover:text-blue-800 font-medium"}," Mark as read ",8,dt))])])])])],10,Z))),128)),n.notifications.length===0?(s(),i("div",ut,e[2]||(e[2]=[t("svg",{class:"w-12 h-12 text-gray-300 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1),t("p",{class:"text-sm text-gray-500"},"No notifications",-1)]))):N("",!0)]))]))}}),ft=b(mt,[["__scopeId","data-v-34ff5cae"]]),pt={class:"bg-white rounded-xl shadow-sm border border-gray-50 overflow-hidden"},gt={class:"px-6 py-4 border-b border-gray-100 flex items-center justify-between"},vt={class:"flex items-center gap-3"},yt={class:"flex items-center gap-2"},xt={class:"px-6 py-6 max-h-[calc(100vh-300px)] overflow-y-auto"},ht={class:"text-base font-bold text-gray-900 mb-2"},_t={class:"flex items-center gap-2 text-sm text-gray-500 mb-6"},bt={class:"prose prose-sm max-w-none mb-6"},kt={class:"text-gray-700 leading-relaxed whitespace-pre-wrap"},wt={class:"mb-6"},$t={class:"inline-flex items-center gap-2 px-3 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm"},Ct=_({__name:"NotificationDetail",props:{notification:{}},emits:["mark-read","mark-unread","close"],setup(k){const u=e=>({urgent:"bg-red-100 text-red-700",high:"bg-orange-100 text-orange-700",normal:"bg-gray-100 text-gray-700"})[e]||"bg-gray-100 text-gray-700",d=e=>e.split("_").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" "),n=e=>new Date(e).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return(e,o)=>(s(),i("div",pt,[t("div",gt,[t("div",vt,[t("span",{class:p(["px-3 py-1 rounded-full text-xs font-semibold",u(e.notification.priority)])},c(e.notification.priority.toUpperCase()),3),t("span",{class:p(["px-3 py-1 rounded-full text-xs font-medium",e.notification.read?"bg-gray-100 text-gray-700":"bg-blue-100 text-blue-700"])},c(e.notification.read?"Read":"Unread"),3)]),t("div",yt,[e.notification.read?(s(),i("button",{key:1,onClick:o[1]||(o[1]=a=>e.$emit("mark-unread",e.notification.notification_id)),class:"px-3 py-1.5 text-sm font-medium text-gray-600 hover:text-gray-800 transition-colors"}," Mark as unread ")):(s(),i("button",{key:0,onClick:o[0]||(o[0]=a=>e.$emit("mark-read",e.notification.notification_id)),class:"px-3 py-1.5 text-sm font-medium text-blue-600 hover:text-blue-800 transition-colors"}," Mark as read ")),t("button",{onClick:o[2]||(o[2]=a=>e.$emit("close")),class:"p-2 text-gray-400 hover:text-gray-600 transition-colors"},o[3]||(o[3]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])]),t("div",xt,[t("h2",ht,c(e.notification.title),1),t("div",_t,[o[4]||(o[4]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("span",null,c(n(e.notification.timestamp)),1)]),t("div",bt,[t("p",kt,c(e.notification.message),1)]),t("div",wt,[t("span",$t,[o[5]||(o[5]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})],-1)),S(" "+c(d(e.notification.notification_type)),1)])])])]))}}),Mt=b(Ct,[["__scopeId","data-v-eacb98ea"]]),Nt={class:"bg-white rounded-xl shadow-sm border border-gray-50 overflow-hidden"},Ft=_({__name:"EmptyState",setup(k){return(u,d)=>(s(),i("div",Nt,d[0]||(d[0]=[z('<div class="flex flex-col items-center justify-center py-16 px-6 text-center" data-v-71f690ee><div class="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6" data-v-71f690ee><svg class="w-12 h-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-71f690ee><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" data-v-71f690ee></path></svg></div><h3 class="text-lg font-semibold text-gray-900 mb-2" data-v-71f690ee> No notification selected </h3><p class="text-sm text-gray-600 max-w-sm" data-v-71f690ee> Select a notification from the list to view its details </p></div>',1)])))}}),Bt=b(Ft,[["__scopeId","data-v-71f690ee"]]),jt={class:"min-h-screen"},Ut={class:""},St={class:"mb-6 flex justify-between items-center rounded-xl bg-[#DCF1FF] text-[#005B8F] px-6 py-4 mb-6"},Dt={class:"flex items-center gap-3"},Lt={key:0,class:"px-3 py-1.5 bg-red-100 text-red-700 rounded-full text-sm font-semibold"},Vt=["disabled"],Rt={key:0,class:"flex items-center justify-center py-12"},It={key:1,class:"grid grid-cols-1 lg:grid-cols-12 gap-6"},At={class:"lg:col-span-5 xl:col-span-4"},Tt={class:"lg:col-span-7 xl:col-span-8"},Pt=_({__name:"notification",setup(k){const{loading:u,notifications:d,unreadCount:n,getNotificationFeed:e,markNotificationRead:o,getUnreadCount:a}=K(),m=C(null),g=C(!1),x=C(null),D=E(()=>g.value?d.value.filter(l=>!l.read):d.value);H(async()=>{await h(),await a(),R()}),O(()=>{I()});const h=async()=>{await e({limit:50,offset:0,unread_only:g.value})},F=async()=>{await h(),await a()},L=async()=>{g.value=!g.value,await h()},V=async l=>{m.value=l,l.read||await w(l.notification_id)},w=async l=>{var f;if(await o(l)){const v=d.value.find($=>$.notification_id===l);v&&(v.read=!0),((f=m.value)==null?void 0:f.notification_id)===l&&(m.value.read=!0),await a()}},B=async l=>{var f;const r=d.value.find(v=>v.notification_id===l);r&&(r.read=!1,((f=m.value)==null?void 0:f.notification_id)===l&&(m.value.read=!1),n.value++)},R=()=>{x.value=Q(async()=>{await a(),d.value.filter(r=>!r.read).length!==n.value&&await h()},3e4)},I=()=>{x.value&&(clearInterval(x.value),x.value=null)};return(l,r)=>{const f=ft,v=Mt,$=Bt,A=J;return s(),M(A,{name:"dashboard"},{default:q(()=>{var j;return[t("div",jt,[t("div",Ut,[t("div",St,[r[3]||(r[3]=t("div",null,[t("h1",{class:"text-xl font-bold bg-[#DCF1FF] text-[#005B8F]"},"Notifications"),t("p",{class:"text-base bg-[#DCF1FF] text-[#005B8F] mt-1"},"Stay informed about your iCCaREPO activities and critical alerts.")],-1)),t("div",Dt,[y(n)>0?(s(),i("div",Lt,c(y(n))+" Unread ",1)):N("",!0),t("button",{onClick:L,class:p(["px-4 py-2 rounded-lg text-sm font-medium transition-colors",g.value?"bg-[#005B8F] text-white":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"])},c(g.value?"All":"Unread Only"),3),t("button",{onClick:F,disabled:y(u),class:"px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 text-sm font-medium flex items-center gap-2"},[(s(),i("svg",{class:p(["w-4 h-4",y(u)&&"animate-spin"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},r[1]||(r[1]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]),2)),r[2]||(r[2]=S(" Refresh "))],8,Vt)])]),y(u)&&!l.notifications.length?(s(),i("div",Rt,r[4]||(r[4]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#005B8F]"},null,-1)]))):(s(),i("div",It,[t("div",At,[G(f,{notifications:D.value,"selected-id":(j=m.value)==null?void 0:j.notification_id,loading:y(u),onSelect:V,onMarkRead:w,onMarkUnread:B,onRefresh:F},null,8,["notifications","selected-id","loading"])]),t("div",Tt,[m.value?(s(),M(v,{key:0,notification:m.value,onMarkRead:w,onMarkUnread:B,onClose:r[0]||(r[0]=zt=>m.value=null)},null,8,["notification"])):(s(),M($,{key:1}))])]))])])]}),_:1})}}}),Gt=b(Pt,[["__scopeId","data-v-9e8353d2"]]);export{Gt as default};
