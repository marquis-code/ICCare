import{G as f,u as m}from"./DMGBEUwW.js";import{r as l}from"./DK5MG7Z7.js";const g={$_get_notification_feed:a=>f.get("/notification/feed",{params:a}),$_mark_notification_read:a=>f.post(`/notification/feed/${a}/mark-read`),$_get_unread_count:()=>f.get("/notification/feed/unread/count")},w=()=>{const a=l(!1),u=l([]),c=l(0),{showToast:d}=m();return{loading:a,notifications:u,unreadCount:c,getNotificationFeed:async e=>{var o,r,i,s;a.value=!0;try{const t=await g.$_get_notification_feed(e);if(t.type!=="ERROR")return u.value=t.data,t.data;{const n=((i=(r=(o=t==null?void 0:t.data)==null?void 0:o.detail)==null?void 0:r[0])==null?void 0:i.msg)||((s=t==null?void 0:t.data)==null?void 0:s.error)||"Failed to fetch notifications";return d({title:"Error",message:n,toastType:"error",duration:3e3}),null}}catch(t){return d({title:"Error",message:(t==null?void 0:t.message)||"Something went wrong",toastType:"error",duration:3e3}),null}finally{a.value=!1}},markNotificationRead:async e=>{var o,r,i,s;try{const t=await g.$_mark_notification_read(e);if(t.type!=="ERROR"){const n=u.value.findIndex(_=>_.notification_id===e);return n!==-1&&(u.value[n].read=!0),c.value>0&&c.value--,!0}else{const n=((i=(r=(o=t==null?void 0:t.data)==null?void 0:o.detail)==null?void 0:r[0])==null?void 0:i.msg)||((s=t==null?void 0:t.data)==null?void 0:s.error)||"Failed to mark notification as read";return d({title:"Error",message:n,toastType:"error",duration:3e3}),!1}}catch(t){return d({title:"Error",message:(t==null?void 0:t.message)||"Something went wrong",toastType:"error",duration:3e3}),!1}},getUnreadCount:async()=>{try{const e=await g.$_get_unread_count();return e.type!=="ERROR"?(c.value=e.data.unread_count,e.data.unread_count):null}catch{return null}}}};export{w as u};
