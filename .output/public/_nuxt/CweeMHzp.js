import{B as K,E as P,I as _,z as T,J as $,r as h,K as Q,L as q,M as X,N as Y,O as Z,i as N,P as b,g as ee,Q as te,y as I}from"./B8cRixjd.js";function ne(e){return X()?(Y(e),!0):!1}const re=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const oe=Object.prototype.toString,se=e=>oe.call(e)==="[object Object]",ue=()=>{};function ie(...e){if(e.length!==1)return $(...e);const n=e[0];return typeof n=="function"?_(Q(()=>({get:n,set:ue}))):h(n)}function le(e,n){function r(...u){return new Promise((a,f)=>{Promise.resolve(e(()=>n.apply(this,u),{fn:n,thisArg:this,args:u})).then(a).catch(f)})}return r}const x=e=>e();function ae(e=x,n={}){const{initialState:r="active"}=n,u=ie(r==="active");function a(){u.value=!1}function f(){u.value=!0}const v=(...t)=>{u.value&&e(...t)};return{isActive:_(u),pause:a,resume:f,eventFilter:v}}function C(e){return Array.isArray(e)?e:[e]}function ce(e){return q()}function fe(e,n,r={}){const{eventFilter:u=x,...a}=r;return T(e,le(u,n),a)}function pe(e,n,r={}){const{eventFilter:u,initialState:a="active",...f}=r,{eventFilter:v,pause:t,resume:s,isActive:l}=ae(u,{initialState:a});return{stop:fe(e,n,{...f,eventFilter:v}),pause:t,resume:s,isActive:l}}function de(e,n=!0,r){ce()?K(e,r):n?e():P(e)}function ve(e,n,r){return T(e,n,{...r,immediate:!0})}const J=re?window:void 0;function ge(e){var n;const r=b(e);return(n=r==null?void 0:r.$el)!=null?n:r}function L(...e){const n=[],r=()=>{n.forEach(t=>t()),n.length=0},u=(t,s,l,d)=>(t.addEventListener(s,l,d),()=>t.removeEventListener(s,l,d)),a=N(()=>{const t=C(b(e[0])).filter(s=>s!=null);return t.every(s=>typeof s!="string")?t:void 0}),f=ve(()=>{var t,s;return[(s=(t=a.value)==null?void 0:t.map(l=>ge(l)))!=null?s:[J].filter(l=>l!=null),C(b(a.value?e[1]:e[0])),C(ee(a.value?e[2]:e[1])),b(a.value?e[3]:e[2])]},([t,s,l,d])=>{if(r(),!(t!=null&&t.length)||!(s!=null&&s.length)||!(l!=null&&l.length))return;const m=se(d)?{...d}:d;n.push(...t.flatMap(W=>s.flatMap(k=>l.map(A=>u(W,k,A,m)))))},{flush:"post"}),v=()=>{f(),r()};return ne(r),v}const j=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},F="__vueuse_ssr_handlers__",ye=he();function he(){return F in j||(j[F]=j[F]||{}),j[F]}function me(e,n){return ye[e]||n}function Se(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const we={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},V="vueuse-storage";function z(e,n,r,u={}){var a;const{flush:f="pre",deep:v=!0,listenToStorageChanges:t=!0,writeDefaults:s=!0,mergeDefaults:l=!1,shallow:d,window:m=J,eventFilter:W,onError:k=o=>{console.error(o)},initOnMounted:A}=u,S=(d?Z:h)(typeof n=="function"?n():n),g=N(()=>b(e));if(!r)try{r=me("getDefaultStorage",()=>{var o;return(o=J)==null?void 0:o.localStorage})()}catch(o){k(o)}if(!r)return S;const w=b(n),M=Se(w),O=(a=u.serializer)!=null?a:we[M],{pause:D,resume:R}=pe(S,()=>B(S.value),{flush:f,deep:v,eventFilter:W});T(g,()=>E(),{flush:f}),m&&t&&de(()=>{r instanceof Storage?L(m,"storage",E,{passive:!0}):L(m,V,H),A&&E()}),A||E();function U(o,c){if(m){const p={key:g.value,oldValue:o,newValue:c,storageArea:r};m.dispatchEvent(r instanceof Storage?new StorageEvent("storage",p):new CustomEvent(V,{detail:p}))}}function B(o){try{const c=r.getItem(g.value);if(o==null)U(c,null),r.removeItem(g.value);else{const p=O.write(o);c!==p&&(r.setItem(g.value,p),U(c,p))}}catch(c){k(c)}}function G(o){const c=o?o.newValue:r.getItem(g.value);if(c==null)return s&&w!=null&&r.setItem(g.value,O.write(w)),w;if(!o&&l){const p=O.read(c);return typeof l=="function"?l(p,w):M==="object"&&!Array.isArray(p)?{...w,...p}:p}else return typeof c!="string"?c:O.read(c)}function E(o){if(!(o&&o.storageArea!==r)){if(o&&o.key==null){S.value=w;return}if(!(o&&o.key!==g.value)){D();try{(o==null?void 0:o.newValue)!==O.write(S.value)&&(S.value=G(o))}catch(c){k(c)}finally{o?P(R):R()}}}}function H(o){E(o.detail)}return S}h(null);const i={auth:h(),user:h({}),token:h("")},y={auth:h(),user:z("user",{}),token:z("token","")};h(null);T(i.user,e=>{e&&typeof e=="object"&&Object.keys(e).forEach(n=>{y.user.value[n]=e[n]})},{deep:!0});i.auth.value=y.auth.value,i.user.value=y.user.value,i.token.value=y.token.value;const be=()=>{const e=N({get:()=>{var t,s;return((s=(t=i==null?void 0:i.auth)==null?void 0:t.value)==null?void 0:s.id)??""},set:()=>{}}),n=N({get:()=>{var t,s;return(t=i.token)!=null&&t.value?((s=i==null?void 0:i.user)==null?void 0:s.value)!=null&&typeof i.user.value=="object":!1},set:()=>{}}),r=N(()=>{var t;return(t=i==null?void 0:i.user)==null?void 0:t.value.isEmailVerified});return{id:e,isLoggedIn:n,isEmailVerified:r,createUser:t=>{y.token.value=t==null?void 0:t.access_token,y.user.value=t==null?void 0:t.user,i.user.value=t==null?void 0:t.user,i.token.value=t==null?void 0:t.access_token},...i,logOut:()=>{localStorage.clear(),i.user.value=null},updateUser:t=>{const l={...JSON.parse(localStorage.getItem("user")||"{}"),...t};i.user.value=l,localStorage.setItem("user",JSON.stringify(l)),y.user.value=l},setToken:t=>{i.token.value=t,y.token.value=t}}},Oe=te(e=>{const{token:n}=be(),r=!!n.value,u=["/login","/signup","/forgot-password","/reset-password","/verify-login","/verify","/welcome","/privacy-policy","/terms-of-use","/account-selection"],a=u.includes(e.path)||u.some(f=>e.path.startsWith(f+"/"));if(!r&&!a)return I("/login");if(r&&["/login","/register"].includes(e.path))return I("/")});export{Oe as default};
