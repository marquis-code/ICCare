import{e as _,c as l,o as n,a as t,x as N,F as z,z as E,n as v,t as u,k as D,_ as b,d as L,f as H,r as C,p as O,m as q,C as J,q as M,w as G,s as K,h as g,b as Q}from"./DK5MG7Z7.js";import{u as W}from"./DS5AZgsM.js";import{s as X}from"./x_rD_Ya3.js";import"./DMGBEUwW.js";import"./BxEYcx1h.js";const Y={class:"bg-white rounded-xl shadow-sm border border-gray-50 overflow-hidden"},Z={key:0,class:"flex items-center justify-center py-12"},tt={key:1,class:"divide-y divide-gray-100 max-h-[calc(100vh-300px)] overflow-y-auto"},et=["onClick"],ot={class:"flex items-start gap-3"},st={class:"flex-shrink-0 mt-1"},nt={class:"flex-1 min-w-0"},at={class:"flex items-start justify-between gap-2 mb-1"},it={key:0,class:"flex-shrink-0"},rt={class:"text-sm text-gray-600 line-clamp-2 mb-2"},lt={class:"flex items-center justify-between"},dt={class:"text-xs text-gray-500"},ct={class:"flex items-center gap-2"},ut=["onClick"],mt=["onClick"],ft={key:0,class:"px-6 py-12 text-center"},pt=_({__name:"NotificationList",props:{notifications:{},selectedId:{},loading:{type:Boolean}},emits:["select","mark-read","mark-unread","refresh"],setup(k){const m=a=>({urgent:"bg-red-500",high:"bg-orange-500",normal:"bg-gray-400"})[a]||"bg-gray-400",c=a=>{const e=new Date(a),i=Math.floor((new Date().getTime()-e.getTime())/1e3);return i<60?"Just now":i<3600?`${Math.floor(i/60)}m ago`:i<86400?`${Math.floor(i/3600)}h ago`:i<604800?`${Math.floor(i/86400)}d ago`:e.toLocaleDateString("en-US",{month:"short",day:"numeric"})};return(a,e)=>{var o,i;return n(),l("div",Y,[e[3]||(e[3]=t("div",{class:"px-6 py-4 border-b border-gray-100"},[t("h2",{class:"text-lg font-semibold text-gray-900"},"Notifications")],-1)),a.loading&&!((o=a.notifications)!=null&&o.length)?(n(),l("div",Z,e[0]||(e[0]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#005B8F]"},null,-1)]))):(n(),l("div",tt,[(n(!0),l(z,null,E(a.notifications,s=>(n(),l("div",{key:s.notification_id,onClick:f=>a.$emit("select",s),class:v(["px-6 py-4 cursor-pointer transition-colors hover:bg-gray-50",a.selectedId===s.notification_id&&"bg-blue-50",!s.read&&"bg-blue-25"])},[t("div",ot,[t("div",st,[t("div",{class:v(["w-2 h-2 rounded-full",m(s.priority)])},null,2)]),t("div",nt,[t("div",at,[t("h3",{class:v(["text-sm font-medium",s.read?"text-gray-600":"text-gray-900"])},u(s.title),3),s.read?N("",!0):(n(),l("div",it,e[1]||(e[1]=[t("div",{class:"w-2 h-2 bg-[#005B8F] rounded-full"},null,-1)])))]),t("p",rt,u(s.message),1),t("div",lt,[t("span",dt,u(c(s.timestamp)),1),t("div",ct,[s.read?(n(),l("button",{key:1,onClick:D(f=>a.$emit("mark-unread",s.notification_id),["stop"]),class:"text-xs text-gray-600 hover:text-gray-800 font-medium"}," Mark as unread ",8,mt)):(n(),l("button",{key:0,onClick:D(f=>a.$emit("mark-read",s.notification_id),["stop"]),class:"text-xs text-blue-600 hover:text-blue-800 font-medium"}," Mark as read ",8,ut))])])])])],10,et))),128)),((i=a.notifications)==null?void 0:i.length)===0?(n(),l("div",ft,e[2]||(e[2]=[t("svg",{class:"w-12 h-12 text-gray-300 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1),t("p",{class:"text-sm text-gray-500"},"No notifications",-1)]))):N("",!0)]))])}}}),gt=b(pt,[["__scopeId","data-v-1cf68898"]]),vt={class:"bg-white rounded-xl shadow-sm border border-gray-50 overflow-hidden"},yt={class:"px-6 py-4 border-b border-gray-100 flex items-center justify-between"},xt={class:"flex items-center gap-3"},ht={class:"flex items-center gap-2"},_t={class:"px-6 py-6 max-h-[calc(100vh-300px)] overflow-y-auto"},bt={class:"text-base font-bold text-gray-900 mb-2"},kt={class:"flex items-center gap-2 text-sm text-gray-500 mb-6"},wt={class:"prose prose-sm max-w-none mb-6"},$t={class:"text-gray-700 leading-relaxed whitespace-pre-wrap"},Ct={class:"mb-6"},Mt={class:"inline-flex items-center gap-2 px-3 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm"},Nt=_({__name:"NotificationDetail",props:{notification:{}},emits:["mark-read","mark-unread","close"],setup(k){const m=e=>({urgent:"bg-red-100 text-red-700",high:"bg-orange-100 text-orange-700",normal:"bg-gray-100 text-gray-700"})[e]||"bg-gray-100 text-gray-700",c=e=>e.split("_").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" "),a=e=>new Date(e).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return(e,o)=>(n(),l("div",vt,[t("div",yt,[t("div",xt,[t("span",{class:v(["px-3 py-1 rounded-full text-xs font-semibold",m(e.notification.priority)])},u(e.notification.priority.toUpperCase()),3),t("span",{class:v(["px-3 py-1 rounded-full text-xs font-medium",e.notification.read?"bg-gray-100 text-gray-700":"bg-blue-100 text-blue-700"])},u(e.notification.read?"Read":"Unread"),3)]),t("div",ht,[e.notification.read?(n(),l("button",{key:1,onClick:o[1]||(o[1]=i=>e.$emit("mark-unread",e.notification.notification_id)),class:"px-3 py-1.5 text-sm font-medium text-gray-600 hover:text-gray-800 transition-colors"}," Mark as unread ")):(n(),l("button",{key:0,onClick:o[0]||(o[0]=i=>e.$emit("mark-read",e.notification.notification_id)),class:"px-3 py-1.5 text-sm font-medium text-blue-600 hover:text-blue-800 transition-colors"}," Mark as read ")),t("button",{onClick:o[2]||(o[2]=i=>e.$emit("close")),class:"p-2 text-gray-400 hover:text-gray-600 transition-colors"},o[3]||(o[3]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])]),t("div",_t,[t("h2",bt,u(e.notification.title),1),t("div",kt,[o[4]||(o[4]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("span",null,u(a(e.notification.timestamp)),1)]),t("div",wt,[t("p",$t,u(e.notification.message),1)]),t("div",Ct,[t("span",Mt,[o[5]||(o[5]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})],-1)),L(" "+u(c(e.notification.notification_type)),1)])])])]))}}),Ft=b(Nt,[["__scopeId","data-v-eacb98ea"]]),Bt={class:"bg-white rounded-xl shadow-sm border border-gray-50 overflow-hidden"},jt=_({__name:"EmptyState",setup(k){return(m,c)=>(n(),l("div",Bt,c[0]||(c[0]=[H('<div class="flex flex-col items-center justify-center py-16 px-6 text-center" data-v-71f690ee><div class="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6" data-v-71f690ee><svg class="w-12 h-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-71f690ee><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" data-v-71f690ee></path></svg></div><h3 class="text-lg font-semibold text-gray-900 mb-2" data-v-71f690ee> No notification selected </h3><p class="text-sm text-gray-600 max-w-sm" data-v-71f690ee> Select a notification from the list to view its details </p></div>',1)])))}}),Ut=b(jt,[["__scopeId","data-v-71f690ee"]]),St={class:"min-h-screen"},Dt={class:""},Lt={class:"mb-6 flex justify-between items-center rounded-xl bg-[#DCF1FF] text-[#005B8F] px-6 py-4 mb-6"},Vt={class:"flex items-center gap-3"},Rt={key:0,class:"px-3 py-1.5 bg-red-100 text-red-700 rounded-full text-sm font-semibold"},It=["disabled"],At={key:0,class:"flex items-center justify-center py-12"},Tt={key:1,class:"grid grid-cols-1 lg:grid-cols-12 gap-6"},Pt={class:"lg:col-span-5 xl:col-span-4"},zt={class:"lg:col-span-7 xl:col-span-8"},Et=_({__name:"notification",setup(k){const{loading:m,notifications:c,unreadCount:a,getNotificationFeed:e,markNotificationRead:o,getUnreadCount:i}=W(),s=C(null),f=C(!1),x=C(null),V=O(()=>f.value?c.value.filter(d=>!d.read):c.value);q(async()=>{await h(),await i(),A()}),J(()=>{T()});const h=async()=>{await e({limit:50,offset:0,unread_only:f.value})},F=async()=>{await h(),await i()},R=async()=>{f.value=!f.value,await h()},I=async d=>{s.value=d,d.read||await w(d.notification_id)},w=async d=>{var p;if(await o(d)){const y=c.value.find($=>$.notification_id===d);y&&(y.read=!0),((p=s.value)==null?void 0:p.notification_id)===d&&(s.value.read=!0),await i()}},B=async d=>{var p;const r=c.value.find(y=>y.notification_id===d);r&&(r.read=!1,((p=s.value)==null?void 0:p.notification_id)===d&&(s.value.read=!1),a.value++)},A=()=>{x.value=X(async()=>{var r;await i(),((r=c.value.filter(p=>!p.read))==null?void 0:r.length)!==a.value&&await h()},3e4)},T=()=>{x.value&&(clearInterval(x.value),x.value=null)};return(d,r)=>{const p=gt,y=Ft,$=Ut,P=K;return n(),M(P,{name:"dashboard"},{default:G(()=>{var j,U,S;return[t("div",St,[t("div",Dt,[t("div",Lt,[r[3]||(r[3]=t("div",null,[t("h1",{class:"text-xl font-bold bg-[#DCF1FF] text-[#005B8F]"},"Notifications"),t("p",{class:"text-base bg-[#DCF1FF] text-[#005B8F] mt-1"},"Stay informed about your iCCaREPO activities and critical alerts.")],-1)),t("div",Vt,[g(a)>0?(n(),l("div",Rt,u(g(a))+" Unread ",1)):N("",!0),t("button",{onClick:R,class:v(["px-4 py-2 rounded-lg text-sm font-medium transition-colors",f.value?"bg-[#005B8F] text-white":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"])},u(f.value?"All":"Unread Only"),3),t("button",{onClick:F,disabled:g(m),class:"px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 text-sm font-medium flex items-center gap-2"},[(n(),l("svg",{class:v(["w-4 h-4",g(m)&&"animate-spin"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},r[1]||(r[1]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]),2)),r[2]||(r[2]=L(" Refresh "))],8,It)])]),g(m)&&!((U=(j=g(c))==null?void 0:j.value)!=null&&U.length)?(n(),l("div",At,r[4]||(r[4]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#005B8F]"},null,-1)]))):(n(),l("div",Tt,[t("div",Pt,[Q(p,{notifications:V.value,"selected-id":(S=s.value)==null?void 0:S.notification_id,loading:g(m),onSelect:I,onMarkRead:w,onMarkUnread:B,onRefresh:F},null,8,["notifications","selected-id","loading"])]),t("div",zt,[s.value?(n(),M(y,{key:0,notification:s.value,onMarkRead:w,onMarkUnread:B,onClose:r[0]||(r[0]=Ht=>s.value=null)},null,8,["notification"])):(n(),M($,{key:1}))])]))])])]}),_:1})}}}),Qt=b(Et,[["__scopeId","data-v-1db5791d"]]);export{Qt as default};
